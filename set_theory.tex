\newcommand{\ran}{\ensuremath{\operatorname{ran}}}

\chapter{Set Theory}

\section{Sets and Functions}
%Sets and functions form a category

\subsection{Primitive Notions}

Let there be \emph{sets}.

Given sets $A$ and $B$, let there be \emph{functions} from $A$ to $B$. We
write $f : A \rightarrow B$ iff $f$ is a function from $A$ to $B$, and we call $A$ the \emph{domain} of $f$ and $B$ the \emph{codomain} of $f$.

Given sets $A$, $B$, $C$ and functions $f : A \rightarrow B$ and $g : B \rightarrow C$, let there be
a function $g \circ f : A \rightarrow C$, the \emph{composite} of $f$ and $g$.

\begin{df}[Injective]
  A function $f : A \rightarrow B$ is \emph{injective}, $f : A \rightarrowtail B$, iff, for every set $X$ and functions $x, y : X \rightarrow A$, if $f \circ x = f \circ y$ then $x = y$.
\end{df}

\subsection{The Axiom of Associativity}

\begin{ax}[Axiom of Associativity]
  Let $A$, $B$ and $C$ be sets.
  Let $f : A \rightarrow B$, $g : B \rightarrow C$ and $h : C \rightarrow D$.
  Then $h \circ (g \circ f) = (h \circ g) \circ f : A \rightarrow D$.
\end{ax}

From now on we write $h \circ g \circ f$ for the composite of $f$, $g$ and
$h$, and similarly for more than three functions.

\subsection{Identity Functions}

\begin{df}[Identity Function]
  Let $A$ be a set. An \emph{identity function} on $A$ is a function $i : A \rightarrow A$ such that:
  \begin{description}
  \item[Left Unit Law]
  For every set $X$ and function $f : X \rightarrow A$, we have $i \circ f = f : X \rightarrow A$.
  \item[Right Unit Law]
  For every set $X$ and function $f : A \rightarrow X$, we have $f \circ i = f : A \rightarrow X$.
  \end{description}
\end{df}

\begin{prop}
  Any two identity functions on a set are equal.
\end{prop}

\begin{proof}
  \pf
  \step{<1>1}{\pflet{$A$ be a set.}}
  \step{<1>2}{\pflet{$i, j : A \rightarrow A$ be identity functions on $A$.}}
  \step{<1>3}{$i = j : A \rightarrow A$}
  \begin{proof}
    \pf
    \begin{align*}
      i & = i \circ j & (\text{Right Unit Law for $j$, \stepref{<1>2}}) \\
      & = j & (\text{Left Unit Law for $i$, \stepref{<1>2}})
    \end{align*}
  \end{proof}
  \qed
\end{proof}

\begin{ax}[Identity Functions]
  Every set has an identity function.
\end{ax}

Given a set $A$, we write $\id{A}$ for the identity function on $A$.

\begin{ax}[Terminal Set]
  There exists a \emph{terminal set} 1 such that, for every set $X$, there exists a unique function $! : X \rightarrow 1$.
\end{ax}

\begin{ax}[Products]
  For any sets $A$ and $B$ there exists a set $A \times B$, the \emph{product} of $A$ and $B$, and functions $\pi_1 : A \times B \rightarrow A$, $\pi_2 : A \times B \rightarrow B$, the \emph{projections}, such that, for every set $X$ and functions $f : X \rightarrow A$, $g : X \rightarrow B$, there exists a unique function $\langle f, g \rangle : X \rightarrow A \times B$ such that $\pi_1 \circ \langle f, g \rangle = f$ and $\pi_2 \circ \langle f, g \rangle = g$.
\end{ax}

\begin{ax}[Equalizers]
  For any sets $A$ and $B$ and functions $f, g : A \rightarrow B$, there exists a set $E$ and function $e : E \rightarrow A$, the \emph{equalizer} of $f$ and $g$, such that:
  \begin{itemize}
    \item
    $f \circ e = g \circ e$
    \item
    for every set $X$ and function $x : X \rightarrow A$ such that $f \circ x = g \circ x$, there exists a unique function $\overline{x} : X \rightarrow E$ such that $x = e \circ \overline{x}$.
  \end{itemize}
\end{ax}

\section{The Basics}

\begin{lm}
  \label{lm:set_theory:union_of_subsets}
  Let $X$ be a set, $\mathcal{B} \subseteq \mathcal{P} X$ and $U \subseteq
  X$. Then the following are equivalent:
  \begin{enumerate}
    \item For all $x \in U$ there exists $B \in \mathcal{B}$ such that $x \in
    B \subseteq U$.
    \item There exists $\mathcal{B}_0 \subseteq \mathcal{B}$ such that $U =
    \bigcup \mathcal{B}_0$.
  \end{enumerate}
\end{lm}

\begin{proof}
  \pf
  \step{<1>1}{$1 \Rightarrow 2$}
  \begin{proof}
    \pf\ If 1 is true then $U = \bigcup \{ B \in \mathcal{B} : B \subseteq U
    \}$.
  \end{proof}
  \step{<1>2}{$2 \Rightarrow 1$}
  \begin{proof}
    \pf\ Trivial.
  \end{proof}
  \qed
\end{proof}

\begin{df}[Fixed Point]
  Let $X$ be a set, $f : X \rightarrow X$, and $x \in X$. Then $x$ is a
  \emph{fixed point} of $f$ iff $f(x) = x$.
\end{df}

\begin{df}[Saturated]
  Let $X$, $Y$ be sets and $p : X \twoheadrightarrow Y$ be a surjective
  function. Let $C \subseteq X$. Then $C$ is \emph{saturated} with respect to
  $p$ iff, for all $x, x' \in X$, if $x \in C$ and $p(x) = p(x')$ then $x'
  \in
  C$.
\end{df}

\begin{df}[Cover]
  Let $A$ be a set and $\mathcal{C} \subseteq \mathcal{P}
  A$. Then $\mathcal{C}$ \emph{covers} $A$ iff $\bigcup \mathcal{C} = A$.
\end{df}

\begin{df}[Finite Intersection Property]
  Let $X$ be a set and $\mathcal{C} \subseteq \mathcal{P} X$. Then
  $\mathcal{C}$ has the \emph{finite intersection property} if and only if
  every finite nonempty subset of $\mathcal{C}$ has nonempty intersection.
\end{df}

\begin{lm}[AC]
  \label{lm:sets:finite_intersection_property:maximal}
  Let $X$ be a set and $\mathcal{A} \subseteq \mathcal{P} X$ have the finite intersection property. Then there exists
  a maximal $\mathcal{D} \subseteq \mathcal{P} X$ that has the finite intersection property and includes $\mathcal{A}$.
\end{lm}

\begin{proof}
  \pf\ A straightforward application of Zorn's lemma, since the union of a chain of sets that has the finite intersection property has the finite intersection property. \qed
\end{proof}

\begin{lm}
  \label{lm:sets:finite_intersection_property:finite_intersection}
  Let $X$ be a set and $\mathcal{D} \subseteq \mathcal{P} X$ be maximal with respect to the finite intersection property. Then any finite intersection of elements of $\mathcal{D}$ is an element of $\mathcal{D}$.
\end{lm}

\begin{proof}
  \pf
  \step{<1>1}{\pflet{$A$ be a finite intersection of elements of $\mathcal{D}$}}
  \step{<1>2}{$\mathcal{D} \cup \{ A \}$ has the finite intersection property.}
  \step{<1>3}{$\mathcal{D} \cup \{ A \} = \mathcal{D}$}
  \qed
\end{proof}

\begin{lm}
  \label{lm:sets:finite_intersection_property:intersect_all}
  Let $X$ be a set and $\mathcal{D} \subseteq \mathcal{P} X$ be maximal with respect to the finite intersection property. If $A \subseteq X$ intersects every element of $\mathcal{D}$ then $A \in \mathcal{D}$.
\end{lm}

\begin{proof}
  \pf\ This holds because $\mathcal{D} \cup \{ A \}$ satisfies the finite intersection property. \qed
\end{proof}

\begin{df}[Graph]
  Let $f : A \rightarrow B$. The \emph{graph} of $f$ is the set $\{ (x, f(x))
  : x \in A \} \subseteq A \times B$.
\end{df}

 \begin{df}[Point-Finite]
 Let $X$ be a set and $\{ A_\alpha \}_{\alpha \in J}$ be a family of subsets
 of $X$. Then $\{ A_\alpha \}_{\alpha \in J}$ is \emph{point-finite} iff, for
all $x \in X$, there are only finitely many $\alpha \in J$ such that $x \in
A_\alpha$.
\end{df}

\begin{df}[Countable Intersection Property]
  A family of parts of a set $X$ has the \emph{countable intersection property} iff every countable subfamily has nonempty intersection.
\end{df}

\section{Refinements}

\begin{df}[Refinement]
  Let $X$ be a set and $\mathcal{A}, \mathcal{B} \subseteq \mathcal{P} X$. Then $\mathcal{B}$ is a \emph{refinement} of $\mathcal{A}$ iff, for all $B \in \mathcal{B}$, there exists $A \in \mathcal{A}$ such that $B \subseteq A$.
\end{df}

\section{Order Theory}

  \begin{df}[Cofinal]
  Let $J$ be a poset and $K \subseteq J$. Then $K$ is \emph{cofinal} iff, for
all $x \in J$, there exists $y \in K$ such that $x \leq y$.
\end{df}

  \begin{df}[Directed Set]
  A \emph{directed set} is a poset $J$ such that, for all $x, y \in J$, there
exists $z \in J$ such that $x \leq z$ and $y \leq z$.
\end{df}

\begin{df}[Linear Order]
  Let $X$ be a set. A \emph{linear order} on $X$ is a relation $\leq
  \subseteq X^2$ such that:
  \begin{itemize}
    \item For all $x \in X$, $x \leq x$
    \item For all $x, y, z \in X$, if $x \leq y$ and $y \leq z$ then $x \leq
    z$
    \item For all $x, y \in X$, if $x \leq y$ and $y \leq x$ then $x = y$
    \item For all $x, y \in X$, we have $x \leq y$ or $y \leq x$
  \end{itemize}
  We write $x < y$ iff $x \leq y$ and $x \neq y$.

  A \emph{linearly ordered set} consists of a set and a linear order on the
  set.
\end{df}

\begin{df}[Convex]
  Let $L$ be a linearly ordered set and $A \subseteq L$. Then $A$ is
  \emph{convex} iff, for all $x, y \in A$ and $z \in L$, if $x < z < y$ then
  $z \in A$.
\end{df}

\begin{df}[Least Upper Bound Property]
  A linearly ordered set $L$ has the \emph{least upper bound property} iff
  every subset of $L$ bounded above has a least upper bound.
\end{df}

\begin{df}[Linear Continuum]
  A \emph{linear continuum} is a linearly ordered set $L$ such that:
  \begin{itemize}
    \item $L$ has the least upper bound property.
    \item For all $x, y \in L$ with $x < y$, there exists $z \in L$ such that
    $x < z < y$.
  \end{itemize}
\end{df}

\begin{prop}
  If $L$ is a linear continuum then every convex subset of $L$ is a linear
  continuum.
\end{prop}

\begin{proof}
  \pf
  \step{<1>1}{\pflet{$L$ be a linear continuum and $C \subseteq L$ be convex}}
  \step{<1>2}{$C$ satisfies the least upper bound property.}
  \begin{proof}
    \step{<2>1}{\pflet{$S \subseteq C$ be nonempty and bounded above by $u$
        in
        $C$.}}
    \step{<2>2}{\pflet{$s$ be the supremum of $S$ in $L$}}
    \step{<2>3}{\pick\ $x \in S$}
    \step{<2>4}{$x \leq s \leq u$}
    \step{<2>5}{$s \in C$}
    \begin{proof}
      \pf\ $C$ is convex.
    \end{proof}
    \step{<2>6}{$s$ is the supremum of $S$ in $C$}
  \end{proof}
  \step{<1>3}{$C$ is dense.}
  \begin{proof}
    \pf
    \step{<2>1}{\pflet{$x, y \in C$ satisfy $x < y$}}
    \step{<2>2}{\pick\ $z \in L$ such that $x < z < y$}
    \step{<2>3}{$z \in C$}
    \begin{proof}
      \pf\ $C$ is convex.
    \end{proof}
  \end{proof}
  \qed
\end{proof}

\begin{lm}
  \label{lm:order:half_open}
  For any real numbers $a$, $b$ with $a < b$ we have $[a, b) \cong [0, 1)$.
\end{lm}

\begin{proof}
  \pf\ The map $\phi : [a, b) \cong [0, 1)$ where $\phi(x) = (x - a) / (b -
  a)$ is an order isomorphism. \qed
\end{proof}

\begin{prop}
  \label{prop:order:zero_one_twice}
  Let $X$ be a linearly ordered set. Let $a, b, c \in X$ with $a < c < b$.
  Then $[a, b) \cong [0, 1)$ if and only if $[a, c) \cong [c, b) \cong [0,
  1)$.
\end{prop}

\begin{proof}
  \pf
  \step{<1>1}{If $[a, b) \cong [0, 1)$ then $[a, c) \cong [c, b) \cong [0,
    1)$.}
  \begin{proof}
    \step{<2>1}{\assume{$\phi : [a, b) \cong [0, 1)$ is an order
        isomorphism.}}
    \step{<2>2}{$[a, c) \cong [0, 1)$}
    \begin{proof}
      \pf
      \begin{align*}
        [a ,c) & \cong [0, \phi(c)) & (\text{under } \phi) \\
        & \cong [0, 1) & (\text{Lemma \ref{lm:order:half_open} })
      \end{align*}
    \end{proof}
    \step{<2>3}{$[c, b) \cong [0, 1)$}
    \begin{proof}
      \pf\ Similar.
    \end{proof}
  \end{proof}
  \step{<1>2}{If $[a, c) \cong [c, b) \cong [0, 1)$ then $[a, b) \cong [0,
    1)$.}
  \begin{proof}
    \step{<2>1}{\assume{$[a, c) \cong [c, b) \cong [0, 1)$}}
    \step{<2>2}{\pflet{$\phi : [a, c) \cong [0, 1/2)$ and $\psi : [c, b)
        \cong
        [1/2, 1)$}}
    \step{<2>3}{\pflet{$\chi : [a, b) \rightarrow [0, 1)$ be given by
        $\chi(x)
        =
        \begin{cases} \phi(x) & \text{if } x < c \\ \psi(x) & \text{if } x
          \geq c \end{cases}$}}
    \step{<2>4}{$\chi : [a, b) \cong [0, 1)$}
    \begin{proof}
      \pf\ Easy to check. % TODO Extract lemma
    \end{proof}
  \end{proof}
  \qed
\end{proof}


\begin{prop}[CC]
  \label{prop:order:zero_one_countable}
  Let $X$ be a linearly ordered set. Let $\{ x_n \}_{n \geq 0}$ be an
  increasing sequence of points of $X$. Suppose $b$ is the supremum of $\{
  x_n : n \geq 0 \}$. Then $[x_0, b) \cong [0, 1)$ if and only if $[x_i,
  x_{i+1}) \cong [0,1)$ for all $i$.
\end{prop}

\begin{proof}
  \pf
  \step{<1>1}{If $[x_0, b) \cong [0, 1)$ then for all $i$ $[x_i, x_{i+1})
    \cong
    [0, 1)$.}
  \begin{proof}
    \pf\ If $\phi : [x_0, b) \cong [0, 1)$ then $[x_i, x_{i+1}) \cong
    [\phi(x_i), \phi(x_{i+1})) \cong [0, 1)$ by Lemma
    \ref{lm:order:half_open}.
  \end{proof}
  \step{<1>2}{If for all $i$ $[x_i, x_{i+1}) \cong [0, 1)$ then $[x_0, b)
    \cong
    [0, 1)$.}
  \begin{proof}
    \pf
    \step{<2>1}{\pflet{$\phi_i : [x_i, x_{i+1}) \cong [0, 1)$ for all $i$}}
    \step{<2>2}{Define $\phi : [x_0, b) \cong [0, 1)$ by: $\phi(y) =
      \phi_i(y) \qquad (x_0 \leq y < b)$ where $i$ is least such that $y <
      i_{i+1}$}
    \begin{proof}
      \pf\ There exists such an $i$ because $y$ is not an upper bound for
      $\{x_n : n \geq 0 \}$.
    \end{proof}
    \step{<2>3}{$\phi$ is an order isomorphism.}
    \begin{proof}
      \pf\ Easy to check.
    \end{proof}
  \end{proof}
  \qed
\end{proof}

\begin{prop}[CC]
  \label{prop:order:long_line_zero_one}
  For all $0 < \alpha < \Omega$, the interval $[(0, 0), (\alpha, 0))$ in
  $S_\Omega \times [0, 1)$ is order isomorphic to $[0, 1)$ in $\mathbb{R}$.
\end{prop}

\begin{proof}
  \pf
  \step{<1>1}{If $[(0, 0), (\alpha, 0)) \cong [0, 1)$ then $[(0, 0), (\alpha
    +
    1,
    0)) \cong [0, 1)$}
  \begin{proof}
    \pf\ By Proposition \ref{prop:order:zero_one_twice}.
  \end{proof}
  \step{<1>2}{Let $\lambda$ be a limit ordinal, $0 < \lambda < \Omega$. If,
    for
    all $\alpha$ with $0 < \alpha < \lambda$, we have $[(0, 0), (\alpha, 0))
    \cong [0, 1)$, then $[(0, 0), (\lambda, 0)) \cong [0, 1)$.}
  \begin{proof}
    \pf\ By Propositoin \ref{prop:order:zero_one_countable}.
  \end{proof}
  \qedstep
  \begin{proof}
    \pf\ By transfinite induction.
  \end{proof}
  \qed
\end{proof}
